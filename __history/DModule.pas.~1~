unit DModule;

interface
                 
uses
  Windows, Messages, SysUtils, Classes, Graphics, Controls, Forms, Dialogs,
  DB, DBTables, DBCtrls, Buttons, ExtCtrls, ADODB, JvExDBGrids, JvDBGrid, JvDBUltimGrid,
  ACBrBase, ACBrSocket, ACBrCEP;

type
  TDM = class(TDataModule)
    DSEmpresas: TDataSource;
    TBHistorico: TADOTable;                                                      
    TBHistoricoCOD_HISTORICO: TStringField;
    DSHistorico: TDataSource;
    TBSaldo: TADOTable;     
    DSSaldo: TDataSource;
    TBSaldoDia_Mes_Ano: TDateField;
    TBSaldoSaldo: TFloatField;                                                                              
    DSSenhas: TDataSource;
    TBSenhas: TADOTable;
    Table1: TADOTable;
    Table1Sequencia: TAutoIncField;
    Table1Dia_Mes_Ano: TDateField;                                                  
    Table1Valor: TFloatField;
    Table1E_S: TStringField;                                          
    Table1HISTORICO: TStringField;
    Table1COD_HISTORICO: TStringField;
    Table1COD_CONTA: TStringField;
    Table2: TADOTable;
    Table2Dia_Mes_Ano: TDateField;
    Table2Saldo: TFloatField;
    TBHistoricoCOD_CONTA: TStringField;
    TBINDICE: TADOTable;
    DSINDICE: TDataSource;
    DSFEDERACA: TDataSource;
    TBSaldoFolha: TSmallintField;
    DSConfDARF: TDataSource;
    TBCONFDARF: TADOTable;
    TBCONFDARFALTURA: TSmallintField;
    TBCONFDARFLARGURA: TSmallintField;
    TBCONFDARFC_01NOME: TSmallintField;
    TBCONFDARFL_01NOME: TSmallintField;
    TBCONFDARFL_01TEL: TSmallintField;
    TBCONFDARFC_DESCR: TSmallintField;
    TBCONFDARFL_DESCR: TSmallintField;
    TBCONFDARFC_01NOMESim: TSmallintField;
    TBCONFDARFL_01NomeSim: TSmallintField;
    TBCONFDARFL_01TELSim: TSmallintField;
    TBCONFDARFC_02a10: TSmallintField;
    TBCONFDARFL_02PERIODO: TSmallintField;
    TBCONFDARFL_03CGC: TSmallintField;
    TBCONFDARFL_04CRECEITA: TSmallintField;
    TBCONFDARFL_05NRVRBA: TSmallintField;
    TBCONFDARFL_06DTVENCPERC: TSmallintField;
    TBCONFDARFL_07VPRINC: TSmallintField;
    TBCONFDARFL_08VMULTA: TSmallintField;
    TBCONFDARFL_09VJUROS: TSmallintField;
    TBCONFDARFL_10VTOTAL: TSmallintField;
    TBDARFA: TADOTable;
    TBDARFAXCGC: TStringField;
    TBDARFAXNOME: TStringField;
    TBDARFAXDESCR: TStringField;
    TBDARFAXTEL: TStringField;
    TBDARFAXPERIODO: TDateField;
    TBDARFAXCODIGO: TStringField;
    TBDARFAXREF: TStringField;
    TBDARFAXVENC: TDateField;
    TBDARFAXVRPRINC: TFloatField;
    TBDARFAXVRMULTA: TFloatField;
    TBDARFAXVRJUROS: TFloatField;
    TBConfDARJ: TADOTable;
    DSConfDARJ: TDataSource;
    TBConfDARJALTURA: TSmallintField;
    TBConfDARJLARGURA: TSmallintField;
    TBConfDARJL_01: TSmallintField;
    TBConfDARJL_02: TSmallintField;
    TBConfDARJL_03: TSmallintField;
    TBConfDARJL_04: TSmallintField;
    TBConfDARJL_05: TSmallintField;
    TBConfDARJL_06: TSmallintField;
    TBConfDARJL_07: TSmallintField;
    TBConfDARJL_08: TSmallintField;
    TBConfDARJL_09: TSmallintField;
    TBConfDARJL_10: TSmallintField;
    TBConfDARJC_01_10: TSmallintField;
    TBConfDARJC_11: TSmallintField;
    TBConfDARJC_12: TSmallintField;
    TBConfDARJC_15: TSmallintField;
    TBConfDARJC_16: TSmallintField;
    TBConfDARJL_11: TSmallintField;
    TBTabelaVP: TADOTable;
    DSTabelaVP: TDataSource;
    DSLancaixa: TDataSource;
    TBCONCX: TADOTable;
    DSCONCX: TDataSource;
    TBLancaixa: TADOTable;
    TBEmpresas: TADOTable;
    TBEmpresascod_empresa: TStringField;
    TBEmpresasendereco: TStringField;
    TBEmpresasnumero: TStringField;
    TBEmpresasbairro: TStringField;
    TBEmpresascomplemento: TStringField;
    TBEmpresascidade: TStringField;
    TBEmpresasestado: TStringField;
    TBEmpresascep: TStringField;
    TBEmpresascgc: TStringField;
    TBEmpresasceivinccgc: TStringField;
    TBEmpresasinscr_estadual: TStringField;
    TBEmpresasinscr_municipal: TStringField;
    TBEmpresasprocesso: TStringField;
    TBEmpresasdecreto: TStringField;
    TBEmpresasdocumento: TStringField;
    TBEmpresascontador: TStringField;
    TBEmpresascrc: TStringField;
    TBEmpresastelefone: TStringField;
    TBEmpresastelddd: TStringField;
    TBEmpresastelnum: TStringField;
    TBEmpresasdata_arquivo: TDateField;
    TBEmpresasxfatservi: TStringField;
    TBEmpresasenquadramento: TStringField;
    TBEmpresascontabil: TStringField;
    TBEmpresasfiscal: TStringField;
    TBEmpresaspessoal: TStringField;
    TBEmpresascaixa: TStringField;
    TBEmpresasc_registro: TStringField;
    TBEmpresasc_diario: TSmallintField;
    TBEmpresasc_razao: TSmallintField;
    TBEmpresasc_caixa: TSmallintField;
    TBEmpresasc_balancete: TSmallintField;
    TBEmpresasc_numreg: TStringField;
    TBEmpresasc_regjc: TStringField;
    TBEmpresasc_datadosaldo: TDateField;
    TBEmpresasc_periodode: TDateField;
    TBEmpresasc_periodoa: TDateField;
    TBEmpresasc_flag: TStringField;
    TBEmpresasc_matriz: TStringField;
    TBEmpresasc_contapartida: TStringField;
    TBEmpresasc_contalucro: TStringField;
    TBEmpresasc_contaprejuizo: TStringField;
    TBEmpresasf_tipo: TStringField;
    TBEmpresasf_xlc: TStringField;
    TBEmpresasf_xldipi: TStringField;
    TBEmpresasf_xcai: TStringField;
    TBEmpresasf_xpisfat: TStringField;
    TBEmpresasf_xcofins: TStringField;
    TBEmpresasf_xcsme: TStringField;
    TBEmpresasf_xcslp: TStringField;
    TBEmpresasf_xirpj: TStringField;
    TBEmpresasf_xsimples: TStringField;
    TBEmpresasf_xmodent: TStringField;
    TBEmpresasf_xmodsai: TStringField;
    TBEmpresasf_xmodicm: TStringField;
    TBEmpresasf_xmodipi: TStringField;
    TBEmpresasf_xmodinv: TStringField;
    TBEmpresasf_xmodservi: TStringField;
    TBEmpresasf_xmodest: TStringField;
    TBEmpresasf_xcc: TStringField;
    TBEmpresasf_xtabela: TStringField;
    TBEmpresasf_xredbc: TStringField;
    TBEmpresasf_xtipogia: TStringField;
    TBEmpresasf_giasn: TStringField;
    TBEmpresasf_xgiadisk: TStringField;
    TBEmpresasf_xmotsubs: TStringField;
    TBEmpresasf_xregime: TStringField;
    TBEmpresasf_cae: TStringField;
    TBEmpresasf_cargo: TStringField;
    TBEmpresasf_xfundese: TStringField;
    TBEmpresasf_xmicrog: TStringField;
    TBEmpresasf_tipoempsp: TStringField;
    TBEmpresasd_fpas: TStringField;
    TBEmpresasd_xpissn: TStringField;
    TBEmpresasd_xtipoemp: TStringField;
    TBEmpresasd_xcodter: TStringField;
    TBEmpresasd_xcodsat: TStringField;
    TBEmpresasd_xcagedsn: TStringField;
    TBEmpresasd_x1declarac: TStringField;
    TBEmpresasd_xencerram: TStringField;
    TBEmpresasd_xmudaend: TStringField;
    TBEmpresasd_xfgtssn: TStringField;
    TBEmpresasd_xagencia: TStringField;
    TBEmpresasd_xbancofgts: TStringField;
    TBEmpresasd_xnatestab: TStringField;
    TBEmpresasd_xcatemp: TStringField;
    TBEmpresasd_xnagencia: TStringField;
    TBEmpresasd_xcontafgts: TStringField;
    TBEmpresasd_xccr: TStringField;
    TBEmpresasd_xraissn: TStringField;
    TBEmpresasd_xproprieta: TStringField;
    TBEmpresasd_xicgccei: TStringField;
    TBEmpresasd_xiende: TStringField;
    TBEmpresasd_xprefixo: TStringField;
    TBEmpresasd_xcausaalt: TStringField;
    TBEmpresasd_xcodmun: TStringField;
    TBEmpresasd_xdatabase: TStringField;
    TBEmpresasd_xinscrant: TStringField;
    TBEmpresasd_xcod: TStringField;
    TBEmpresasd_xcodtra: TStringField;
    TBEmpresasd_xinicio: TDateField;
    TBEmpresasd_xatividade: TStringField;
    TBEmpresasd_xcodativ: TStringField;
    TBEmpresasd_xtipoestab: TStringField;
    TBEmpresasd_xcodrec: TStringField;
    TBEmpresasd_xiacnae: TStringField;
    TBEmpresasd_xtomrais: TStringField;
    TBEmpresasg_codsacado: TStringField;
    TBEmpresasxsitemp: TStringField;
    TBEmpresasxdatasit: TDateField;
    TBEmpresasxiss: TStringField;
    TBEmpresasxexig: TStringField;
    TBEmpresasg_xdiapagto: TStringField;
    TBEmpresasxgrupo: TStringField;
    TBEmpresasf_codpis: TStringField;
    TBEmpresasf_codcofins: TStringField;
    TBEmpresasf_codcs: TStringField;
    TBEmpresasf_codirpj: TStringField;
    TBEmpresasd_pat: TStringField;
    TBEmpresasd_codgps: TStringField;
    TBEmpresasd_xcnae: TStringField;
    TBEmpresascrcuf: TStringField;
    TBEmpresascpfcontador: TStringField;
    TBEmpresasf_xcoddae: TStringField;
    TBEmpresasf_xcoddaefun: TStringField;
    TBEmpresasf_xcompvragr: TStringField;
    TBEmpresasf_xdesm_cae: TStringField;
    TBEmpresasf_xcod_mun_irpj: TStringField;
    TBEmpresasf_xrev_auton: TStringField;
    TBEmpresasx_tipo_integ: TStringField;
    TBEmpresasx_data_saldo_cx: TDateField;
    TBEmpresascx_periodode: TDateField;
    TBEmpresascx_periodoa: TDateField;
    TBEmpresasd_simples: TStringField;
    TBEmpresasf_passo: TStringField;
    TBEmpresasd_iea: TStringField;
    TBEmpresasd_xregime_pag: TStringField;
    TBEmpresasf_ciap: TStringField;
    TBEmpresasf_issqn: TStringField;
    TBEmpresasxemail_resp: TStringField;
    TBEmpresasxbancocomp: TStringField;
    TBEmpresasxtipocc: TStringField;
    TBEmpresasxbanco: TStringField;
    TBEmpresasxcodempbanco: TStringField;
    TBEmpresasxcodagencia: TStringField;
    TBEmpresasxdvagencia: TStringField;
    TBEmpresasxconta: TStringField;
    TBEmpresasxdvconta: TStringField;
    TBEmpresasxdvagenciacc: TStringField;
    TBEmpresasxcafe: TStringField;
    TBEmpresasf_tipocontrib: TStringField;
    TBEmpresasxativoext: TStringField;
    TBEmpresasf_xdf_rcdpe: TDateField;
    TBEmpresasc_xtitulo: TStringField;
    TBEmpresasf_xmoddupli: TStringField;
    TBEmpresasd_xmens_ho01: TStringField;
    TBEmpresasd_xmens_ho02: TStringField;
    TBEmpresasd_xmens_qh01: TStringField;
    TBEmpresasd_xmens_qh02: TStringField;
    TBEmpresasd_xmens_qh03: TStringField;
    TBEmpresasd_xmens_qh04: TStringField;
    query: TADOQuery;
    TBSenhasnome: TStringField;
    TBSenhasnomecompleto: TStringField;
    TBSenhasnivel: TStringField;
    TBSenhassenha: TStringField;
    TBSenhasgrupo: TStringField;
    TBSenhasflag: TStringField;
    TBEmpresasf_xpda291: TBCDField;
    TBEmpresasf_xpsdme: TBCDField;
    TBEmpresasf_xpre: TBCDField;
    TBEmpresasf_xprest: TBCDField;
    TBEmpresasf_xfatanoant: TBCDField;
    TBEmpresasf_xpersimple: TBCDField;
    TBEmpresasf_xnument: TBCDField;
    TBEmpresasf_xnumsai: TBCDField;
    TBEmpresasf_xnumicm: TBCDField;
    TBEmpresasf_xnumipi: TBCDField;
    TBEmpresasf_xnuminv: TBCDField;
    TBEmpresasf_xnumservi: TBCDField;
    TBEmpresasf_xnumest: TBCDField;
    TBEmpresasf_xvalorfix: TBCDField;
    TBEmpresasf_percsp: TBCDField;
    TBEmpresasd_xnsm: TBCDField;
    TBEmpresasd_xpercemp: TBCDField;
    TBEmpresasd_xpercempra: TBCDField;
    TBEmpresasd_xperc: TBCDField;
    TBEmpresasd_xpersat: TBCDField;
    TBEmpresasd_xcapital: TBCDField;
    TBEmpresasg_xvrmensa: TBCDField;
    TBEmpresasxaliss: TBCDField;
    TBEmpresasd_percfrete: TBCDField;
    TBEmpresasd_xpercif: TBCDField;
    TBEmpresasf_xperc_a_a_s: TBCDField;
    TBEmpresasx_vr_saldo_cx: TBCDField;
    TBEmpresasd_pat_sp: TBCDField;
    TBEmpresasd_pat_ac: TBCDField;
    TBEmpresasd_pat_rc: TBCDField;
    TBEmpresasd_pat_rt: TBCDField;
    TBEmpresasd_pat_ca: TBCDField;
    TBEmpresasd_pat_alc: TBCDField;
    TBEmpresasf_xnumdupli: TBCDField;
    TBEmpresasc_flag_lanct: TStringField;
    TBFEDERACA: TADOTable;
    TBFEDERACAsigla: TStringField;
    TBFEDERACAunidade: TStringField;
    TBFEDERACAcodigo: TStringField;
    TBFEDERACAp_zfm_alc: TStringField;
    TBCONCXcod_conta: TStringField;
    TBCONCXnome_conta: TStringField;
    TBCONCXe_s: TStringField;
    TBCONCXtipo: TStringField;
    TBCONCXcod_historico: TStringField;
    TBLancaixasequencia: TAutoIncField;
    TBLancaixadia_mes_ano: TDateField;
    TBLancaixavalor: TBCDField;
    TBLancaixacod_historico: TStringField;
    TBLancaixae_s: TStringField;
    TBLancaixacod_conta: TStringField;
    TBLancaixahistorico: TStringField;
    TBLancaixati: TStringField;
    table_temp: TADOTable;
    TBEmpresasf_xdesm_xcnae: TStringField;
    TBEmpresasxexc_simples: TStringField;
    TBEmpresasxdt_exc_simples: TDateField;
    TBEmpresasxop_refis: TStringField;
    TBEmpresasxop_paes: TStringField;
    TBEmpresasxcontrib_ipi: TStringField;
    TBEmpresasxcontrib_icms: TStringField;
    TBEmpresasxconv_estado: TStringField;
    TBEmpresasxmes_conv_estado: TStringField;
    TBEmpresasxlimite_conv_estado: TStringField;
    TBEmpresasxcontrib_iss: TStringField;
    TBEmpresasxconv_munic: TStringField;
    TBEmpresasxmes_conv_munic: TStringField;
    TBEmpresasxlimite_conv_munic: TStringField;
    qryExp: TADOQuery;
    qry_comandos: TADOQuery;
    TBTabelaVPxcv_inssspag: TStringField;
    TBTabelaVPxcv_insss13s: TStringField;
    TBTabelaVPxcv_insssfer: TStringField;
    TBTabelaVPxcv_irrfsadi: TStringField;
    TBTabelaVPxcv_irrfspag: TStringField;
    TBTabelaVPxcv_irrfs13s: TStringField;
    TBTabelaVPxcv_irrfsfer: TStringField;
    TBTabelaVPxcv_irrfsdfe: TStringField;
    TBINDICEcgc: TStringField;
    TBINDICErazao_social: TStringField;
    TBINDICEendereco: TStringField;
    TBINDICEbairro: TStringField;
    TBINDICEcidade: TStringField;
    TBINDICEestado: TStringField;
    TBINDICEcep: TStringField;
    TBINDICEtel: TStringField;
    TBINDICExcc: TStringField;
    TBINDICEs_contabil: TStringField;
    TBINDICEs_fiscal: TStringField;
    TBINDICEs_pessoal: TStringField;
    TBINDICEs_caixa: TStringField;
    TBINDICEs_gerenciador: TStringField;
    TBINDICExpercpis: TBCDField;
    TBINDICExcodcpis: TStringField;
    TBINDICExdpis: TStringField;
    TBINDICExpercpisd: TBCDField;
    TBINDICExcodcpisd: TStringField;
    TBINDICExdpisd: TStringField;
    TBINDICExpercpisr: TBCDField;
    TBINDICExcodcpisr: TStringField;
    TBINDICExdpisr: TStringField;
    TBINDICExperccofin: TBCDField;
    TBINDICExcodccofin: TStringField;
    TBINDICExdcofins: TStringField;
    TBINDICExperccs: TBCDField;
    TBINDICExcodccs: TStringField;
    TBINDICExdcs: TStringField;
    TBINDICExcodccsme: TStringField;
    TBINDICExperccsme: TBCDField;
    TBINDICExdcsme: TStringField;
    TBINDICExcodcirpj: TStringField;
    TBINDICExpercirpj: TBCDField;
    TBINDICExdirpj: TStringField;
    TBINDICExcodcsimp: TStringField;
    TBINDICExpercsimp: TBCDField;
    TBINDICExdsimp: TStringField;
    TBINDICExmodsimp: TStringField;
    TBINDICExirpj1: TBCDField;
    TBINDICExirpj2: TBCDField;
    TBINDICExirpj3: TBCDField;
    TBINDICExirpj4: TBCDField;
    TBINDICExopcaof1: TStringField;
    TBINDICExopcaof2: TStringField;
    TBINDICExpme01: TBCDField;
    TBINDICExpme02: TBCDField;
    TBINDICExpme03: TBCDField;
    TBINDICExpme04: TBCDField;
    TBINDICExpme05: TBCDField;
    TBINDICExpme06: TBCDField;
    TBINDICExpme07: TBCDField;
    TBINDICExpme08: TBCDField;
    TBINDICExtipodarf: TStringField;
    TBINDICExred1: TBCDField;
    TBINDICExred2: TBCDField;
    TBINDICExred3: TBCDField;
    TBINDICExred4: TBCDField;
    TBINDICExred5: TBCDField;
    TBINDICExred6: TBCDField;
    TBINDICExred7: TBCDField;
    TBINDICExred8: TBCDField;
    TBINDICEm_recibo: TMemoField;
    TBINDICEm_boleto: TMemoField;
    TBINDICEetiqueta_p: TMemoField;
    TBINDICExarrint: TStringField;
    TBINDICExcorrigir: TStringField;
    TBINDICExicmsretsn: TStringField;
    TBINDICExipinasn: TStringField;
    TBINDICExcampo3839: TStringField;
    TBINDICExsrpcf: TStringField;
    TBINDICEdum: TSmallintField;
    TBINDICEddf: TSmallintField;
    TBINDICExmingrps: TBCDField;
    TBINDICExutilmodp10: TStringField;
    TBINDICExmodeloimp: TStringField;
    TBINDICExfonte10cpi: TStringField;
    TBINDICExfonte20cpi: TStringField;
    TBINDICExnumero: TStringField;
    TBINDICExresci42: TStringField;
    TBINDICExresci43: TStringField;
    TBINDICExresci44: TStringField;
    TBINDICExresci45: TStringField;
    TBINDICExresci51: TStringField;
    TBINDICExresci52: TStringField;
    TBINDICExresci53: TStringField;
    TBINDICExversao: TStringField;
    TBINDICEs_ativo: TStringField;
    TBINDICEs_lalur: TStringField;
    TBINDICEs_print: TStringField;
    TBINDICExconvertehora: TStringField;
    TBINDICExdiretor: TStringField;
    TBINDICExdrg: TStringField;
    TBINDICExdcpf: TStringField;
    TBINDICExnlicenca: TStringField;
    TBINDICExfoncondensed: TStringField;
    TBINDICExfonnormal: TStringField;
    TBINDICExfon12cpi: TStringField;
    TBINDICExfon10cpi: TStringField;
    TBINDICExfon12cpireduz: TStringField;
    pvtb: TADOTable;
    TBINDICExcodcliente: TStringField;
    TBINDICEs_web: TStringField;
    TBEmpresasxexpcaixa: TBCDField;
    TBEmpresasxordem: TSmallintField;
    TBEmpresasxmodalidade: TStringField;
    TBEmpresasxsindassoc: TStringField;
    TBEmpresasxvrassoc: TBCDField;
    TBEmpresasxsindsind: TStringField;
    TBEmpresasxvrsind: TBCDField;
    TBEmpresasxsindassis: TStringField;
    TBEmpresasxvrassis: TBCDField;
    TBEmpresasxsindconf: TStringField;
    TBEmpresasxvrconf: TBCDField;
    TBEmpresasxexerativ: TStringField;
    TBEmpresasxsenhaweb: TStringField;
    TBEmpresasxemail_web: TStringField;
    TBEmpresasxexibirweb: TStringField;
    TBINDICEs_tipoweb: TStringField;
    TBEmpresasxcriterio: TStringField;
    TBEmpresasxtipologra: TStringField;
    TBEmpresasxorgao: TStringField;
    TBEmpresasxsocioscp: TSmallintField;
    TBEmpresasxmetodo: TStringField;
    TBEmpresasxpartper: TStringField;
    TBEmpresasxcomelet: TStringField;
    TBEmpresasxroyalrec: TStringField;
    TBEmpresasxroyalpag: TStringField;
    TBEmpresasxrendrel: TStringField;
    TBEmpresasxpagrem: TStringField;
    TBTabProtocolos: TADOTable;
    DSTabProtocolos: TDataSource;
    TBTabProtocolosxcod_protoc_ei: TStringField;
    TBTabProtocolosxdescricao: TStringField;
    TBTabProtocolosxlocal_pagto: TStringField;
    TBHistoricodescr_historico: TStringField;
    TBEmpresasxmajoracao: TStringField;
    TBINDICEs_ledfirst: TStringField;
    TBEmpresasd_xativprinc: TStringField;
    TBEmpresasg_xcontainteg: TStringField;
    ADOOnLine: TADOConnection;
    TBEmpresasxcompresumo: TStringField;
    TBINDICExdata_atu: TDateField;
    TBINDICExflag_atu: TStringField;
    TBEmpresasxinovtec: TStringField;
    TBEmpresasxtrib1t: TStringField;
    TBEmpresasxtrib2t: TStringField;
    TBEmpresasxqualifpj: TStringField;
    TBEmpresasxbalanco: TStringField;
    TBEmpresasxmes1: TStringField;
    TBEmpresasxmes2: TStringField;
    TBEmpresasxmes3: TStringField;
    TBEmpresasxmes4: TStringField;
    TBEmpresasxmes5: TStringField;
    TBEmpresasxmes6: TStringField;
    TBEmpresasxscp: TStringField;
    TBEmpresasxincorp: TStringField;
    TBEmpresasxdctf: TStringField;
    TBEmpresasxvarpis: TStringField;
    TBEmpresasxvarcofins: TStringField;
    TBEmpresasxvarcs: TStringField;
    TBEmpresasxvarirpj: TStringField;
    TBEmpresasf_xipi: TStringField;
    TBEmpresasf_codipi: TStringField;
    TBEmpresasxvaripi: TStringField;
    TBINDICExcabousb: TStringField;
    TBEmpresasxindcentr: TStringField;
    TBEmpresasxintegclp: TStringField;
    data_gerente: TDataSource;
    data_mntgerente: TDataSource;
    data_novogerente: TDataSource;
    query_gerente: TADOQuery;
    table_gerente: TADOTable;
    table_gerentexid: TAutoIncField;
    table_gerentexstatus: TStringField;
    table_gerentexobrigacao: TStringField;
    table_gerentexcod_empresa: TStringField;
    table_gerentexnome_empresa: TStringField;
    table_gerentexcod_func: TStringField;
    table_gerentexnome_func: TStringField;
    table_gerentexnome_dep: TStringField;
    table_gerentexcampos: TStringField;
    table_gerentexdata_venc: TDateField;
    TBEmpresasxpjcomexp: TStringField;
    TBEmpresasxpjefet: TStringField;
    TBINDICEinscr_estadual: TStringField;
    TBEmpresasxaliq_cofins: TBCDField;
    TBEmpresasxaliq_cs: TBCDField;
    TBEmpresasxfat_serv_cs: TStringField;
    TBEmpresasxsuframa: TStringField;
    TBEmpresasxind_perfil: TStringField;
    TBEmpresasxind_ativ: TStringField;
    TBINDICExemail: TStringField;
    TBINDICExcod_mun: TStringField;
    TBEmpresasxconv_icms_115: TStringField;
    TBEmpresasxapuripi: TStringField;
    TBEmpresasxsped_fiscal: TStringField;
    TBEmpresasxcod_ent_ref_conta: TStringField;
    TBEmpresasxcod_ent_ref_cad: TStringField;
    TBEmpresasxpjcsll15: TStringField;
    TBEmpresasxoprtt: TStringField;
    TBEmpresasxconttec: TStringField;
    TBEmpresasxsped_contabil: TStringField;
    ADOConEmpresa: TADOConnection;
    ADOConPrimario: TADOConnection;
    ADOConExp: TADOConnection;
    ADOpvdb: TADOConnection;
    TBINDICExlogoemp: TBlobField;
    TBINDICExid: TAutoIncField;
    TBCONFDARFxid: TAutoIncField;
    TBConfDARJxid: TAutoIncField;
    TBTabelaVPxid: TAutoIncField;
    TBEmpresasxesc_cent: TStringField;
    TBINDICExmsg1: TStringField;
    TBINDICExmsg2: TStringField;
    TBINDICExpriorimens: TStringField;
    DSSIGNATARIO: TDataSource;
    TBSIGNATARIO: TADOTable;
    TBSIGNATARIOxcpf: TStringField;
    TBSIGNATARIOxnome: TStringField;
    TBSIGNATARIOxqualif: TStringField;
    TBEmpresasxpconta11638: TStringField;
    TBEmpresasxlayout: TStringField;
    TBEmpresasxfap: TBCDField;
    TBEmpresasxseqiss: TIntegerField;
    TBEmpresasxnome_fantasia: TStringField;
    TBEmpresasxcrit_rec_vmon: TStringField;
    TBEmpresasxaus_deb_jan: TStringField;
    TBEmpresasxaus_deb_fev: TStringField;
    TBEmpresasxaus_deb_mar: TStringField;
    TBEmpresasxaus_deb_abr: TStringField;
    TBEmpresasxaus_deb_mai: TStringField;
    TBEmpresasxaus_deb_jun: TStringField;
    TBEmpresasxaus_deb_jul: TStringField;
    TBEmpresasxaus_deb_ago: TStringField;
    TBEmpresasxaus_deb_set: TStringField;
    TBEmpresasxaus_deb_out: TStringField;
    TBEmpresasxaus_deb_nov: TStringField;
    TBEmpresasxaus_deb_dez: TStringField;
    TBEmpresasxapu_pis_cof: TStringField;
    TBEmpresasxpj_ativ_mes: TStringField;
    TBEmpresasxdeb_scp_inc: TStringField;
    ADOConLog: TADOConnection;
    TBEmpresasxind_apro_cred: TStringField;
    TBEmpresasxcd_int_empresa: TAutoIncField;
    TBEmpresasxdt_ato_simp_emp: TDateTimeField;
    TBEmpresasxcod_inc_trib: TStringField;
    TBEmpresasxcod_tipo_cont: TStringField;
    TBEmpresasxrec_cred_ret: TStringField;
    TBEmpresasxind_nat_pj: TStringField;
    TBEmpresasxobs_empresa: TMemoField;
    TBEmpresasf_xnumservi_tom: TIntegerField;
    TBEmpresasf_xmodservi_tom: TStringField;
    TBEmpresasxlucro_real_lei: TStringField;
    TBEmpresasxlei4056: TStringField;
    TBEmpresasxlei12546: TStringField;
    TBEmpresasxperc_lei12546: TBCDField;
    TBEmpresasxdarflei12546: TStringField;
    TBEmpresasxapcredativo: TStringField;
    TBEmpresasxrazao_social_conta: TStringField;
    TBEmpresasxcgc_conta: TStringField;
    TBEmpresasxformesc: TStringField;
    TBEmpresasxinteg_aut: TStringField;
    TBEmpresasxma_integ_aut: TStringField;
    TBEmpresasxinteg_matriz: TStringField;
    qryIntegracaoAutomatica: TADOQuery;
    TBEmpresasxindcrit: TStringField;
    TBEmpresasxregrapreco: TStringField;
    TBEmpresasxnacionalidade: TStringField;
    TBEmpresasxestado_civil: TStringField;
    TBEmpresasxprofissao: TStringField;
    TBEmpresasxrg: TStringField;
    TBEmpresasxtrava_integracao: TStringField;
    TBEmpresasxdif_vc_bcserv: TStringField;
    TBEmpresasxtrava_lancto: TStringField;
    TBEmpresasxrg_resp: TStringField;
    TBEmpresasnome_resp: TStringField;
    TBINDICExdias_mes: TStringField;
    TBEmpresasxnome_auditor: TStringField;
    TBEmpresasxreg_auditor: TStringField;
    TBEmpresasxenc_exercicio_social: TStringField;
    TBEmpresasxorgao_resp: TStringField;
    TBEmpresasxuforgao_resp: TStringField;
    TBEmpresasf_xnumcod_merc: TIntegerField;
    TBEmpresasf_xmodcod_merc: TStringField;
    TBEmpresasxresci42: TStringField;
    TBEmpresasxresci43: TStringField;
    TBEmpresasxresci44: TStringField;
    TBEmpresasxresci45: TStringField;
    TBEmpresasxresci51: TStringField;
    TBEmpresasxresci52: TStringField;
    TBEmpresasxresci53: TStringField;
    TBEmpresasxresci661: TStringField;
    TBEmpresasxresci95: TStringField;
    TBEmpresasxresci951: TStringField;
    TBEmpresasxresci952: TStringField;
    TBEmpresasxresci953: TStringField;
    TBEmpresasxresci954: TStringField;
    TBEmpresasxresci955: TStringField;
    TBEmpresasxresci115: TStringField;
    TBEmpresasxresci1151: TStringField;
    TBEmpresasxresci1152: TStringField;
    TBEmpresasxresci1153: TStringField;
    TBEmpresasxresci1154: TStringField;
    TBEmpresasxresci1155: TStringField;
    TBEmpresasxsitdeclaracao: TStringField;
    TBEmpresasxlei12_973_2014: TStringField;
    TBEmpresasLogoMarca: TBlobField;
    TBEmpresasxtrava_mes_dp: TStringField;
    TBEmpresasxporte_estab: TStringField;
    TBEmpresasxcontrole_ponto: TStringField;
    TBEmpresasxorgao_domes: TStringField;
    TBEmpresasxuforgao_domes: TStringField;
    TBEmpresasEncExercSocFiscal: TStringField;
    TBEmpresasc_ultfolhadiario: TIntegerField;
    TBEmpresasc_ultfolharazao: TIntegerField;
    TBEmpresasc_ultfolhacaixa: TIntegerField;
    TBEmpresasc_ultfolhabalancete: TIntegerField;
    TBEmpresasTipo_Escrit: TStringField;
    TBEmpresasAtiv_Rural: TStringField;
    TBEmpresasForma_Trib: TStringField;
    TBINDICEcomplemento: TStringField;
    TBINDICExmes_prop: TStringField;
    TBEmpresasNota_Indice_Liquidez: TMemoField;
    TBEmpresasSenhaCertificado: TStringField;
    TBEmpresasTipoEmissaoCertificado: TStringField;
    TBEmpresascaminhoCertificado: TStringField;
    TBEmpresasxdif_aliq_apartir: TStringField;
    TBEmpresasNumSerieCertificado: TStringField;
    TBEmpresasdif_aliq_interestadual: TStringField;
    TBEmpresaspagto_plano_privado: TStringField;
    TBEmpresasadm_fundo_invest: TStringField;
    TBEmpresasinst_financ: TStringField;
    TBEmpresaspagto_res_dom_exter: TStringField;
    TBEmpresassocio_ostensivo: TStringField;
    TBEmpresaspagto_jogos_olimp: TStringField;
    TBEmpresasnotariais: TStringField;
    TBINDICExJustaCausa_FeriasPropor: TStringField;
    TBINDICExassunto_email: TStringField;
    TBINDICExcorpo_email: TStringField;
    TBEmpresasf_codirrf: TStringField;
    TBEmpresasf_codcsrf: TStringField;
    TBEmpresasxvarirrf: TStringField;
    TBEmpresasxvarcsrf: TStringField;
    TBEmpresasf_xirrf: TStringField;
    TBEmpresasf_xcsrf: TStringField;
    TBEmpresasnome_empresa: TStringField;
    TBINDICExassunto_email_adian: TStringField;
    TBINDICExcorpo_email_adian: TStringField;
    TBINDICExassunto_email_13: TStringField;
    TBINDICExcorpo_email_13: TStringField;
    TBEmpresasPJ_Habil: TStringField;
    TBINDICExassunto_email_hono: TStringField;
    TBINDICExcorpo_email_hono: TStringField;
    TBEmpresasclausula_contra_safri: TMemoField;
    TBEmpresasclausula_contra_expParcial: TMemoField;
    TBEmpresasclausula_contra_exp: TMemoField;
    TBINDICExaviso184_2012: TStringField;
    TBEmpresaseS_CodClassTrib: TStringField;
    TBEmpresaseS_IndCooperativa: TIntegerField;
    TBEmpresaseS_IndConstrutora: TIntegerField;
    TBEmpresaseS_IndDesoFolha: TIntegerField;
    TBEmpresaseS_OpRegEletEmp: TIntegerField;
    TBEmpresaseS_EntSemFinsLuc: TStringField;
    TBEmpresaseS_EmpTrabTemp: TStringField;
    TBEmpresaseS_RegEmpTempMinist: TStringField;
    TBEmpresaseS_SiglaMinisterioCert: TStringField;
    TBEmpresaseS_NumCert: TStringField;
    TBEmpresaseS_DtEmissaoCert: TDateTimeField;
    TBEmpresaseS_DtVencimentoCert: TDateTimeField;
    TBEmpresaseS_ProtPedRenov: TStringField;
    TBEmpresaseS_DtProtRenov: TDateTimeField;
    TBEmpresaseS_DtPublDOU: TDateTimeField;
    TBEmpresaseS_NumPagDOU: TIntegerField;
    TBEmpresaseS_NumSIAFI: TStringField;
    TBEmpresaseS_OrgPublEFR: TStringField;
    TBEmpresaseS_CNPJEFR: TStringField;
    TBEmpresaseS_EnteFedeOrg: TStringField;
    TBEmpresaseS_UFFedeOrg: TStringField;
    TBEmpresaseS_CodMun: TStringField;
    TBEmpresaseS_RegPrevSocial: TStringField;
    TBEmpresaseS_Subteto: TIntegerField;
    TBEmpresaseS_VrSubteto: TBCDField;
    TBEmpresaseS_IsencaoMulta: TIntegerField;
    TBEmpresaseS_DtInicioObrig: TDateTimeField;
    TBEmpresaseS_DtFimObrig: TDateTimeField;
    TBEmpresasTelefone_resp: TStringField;
    TBEmpresasCelular_resp: TStringField;
    TBEmpresaseS_TipoEmissaoCertificado: TStringField;
    TBEmpresasdirf_registrar_siafi: TStringField;
    TBEmpresasderex: TStringField;
    ADOConMunicipios: TADOConnection;
    TBEmpresasclausula_contra_inter: TMemoField;
    TBEmpresaseS_caminhoCertificadoProc: TStringField;
    TBEmpresaseS_SenhaCertificadoProc: TStringField;
    TBEmpresaseS_TipoEmissaoCertificadoProc: TStringField;
    TBEmpresaseS_NumSerieCertificadoProc: TStringField;
    TBEmpresaseS_NumCnpjCpfProc: TStringField;
    TBEmpresasDescont_Falta_Dsr: TStringField;
    TBEmpresasdapisef00_termo_aceite: TStringField;
    TBEmpresasindSimples: TIntegerField;
    TBEmpresastipoSSL: TStringField;
    TBEmpresaseS_tipoSSL: TStringField;
    TBINDICEInativarTodas_EMP_eSocial: TStringField;
    TBEmpresasreinf_AmbOficial_DtIniTabelas: TStringField;
    TBEmpresasreinf_AmbTestes_DtIniTabelas: TStringField;
    TBEmpresaseS_AmbTestes_DtInicioTabelas: TStringField;
    TBEmpresaseS_AmbTestes_DtInicioNaoPeriodicos: TStringField;
    TBEmpresaseS_AmbTestes_DtInicioPeriodicos: TStringField;
    TBEmpresaseS_AmbOficial_DtInicioTabelas: TStringField;
    TBEmpresaseS_AmbOficial_DtInicioNaoPeriodicos: TStringField;
    TBEmpresaseS_AmbOficial_DtInicioPeriodicos: TStringField;
    TBEmpresascheck_AcrescerIcmsRetido_DARF: TStringField;
    TBEmpresascheck_DeduzirIcmsRetido_DARF: TStringField;
    TBEmpresascheck_DeduzirIcmsRetido_DARF_DP: TStringField;
    TBEmpresaseS_IndProdRural: TIntegerField;
    TBEmpresasQuadro_Informativo_Adiantamento_5: TStringField;
    TBEmpresasexisteEmpCNPJCPF: TStringField;
    TBEmpresasAtivarDesativarGestorOnTime: TStringField;
    tbInfo: TADOTable;
    tbInfoid_Export_Prot_Evento: TIntegerField;
    tbInfoEvento: TStringField;
    tbInfoNumero_Recibo: TStringField;
    tbInfoIdentificacao: TStringField;
    tbInfoperApuracao: TStringField;
    tbInfoNome: TStringField;
    tbInfoTipo: TStringField;
    tbInfoxCheck: TBooleanField;
    tbInfoNIS: TStringField;
    tbInfoCateSocial: TIntegerField;
    tbInfoChaveFuncSocAuto: TStringField;
    TBEmpresastpInsc_eSocial: TStringField;
    TBEmpresasnrInsc_eSocial: TStringField;
    TBEmpresasIndiceCargoFuncao: TIntegerField;
    TBEmpresasinssPropFerias: TStringField;
    TBEmpresasxExportaLcdpr: TBooleanField;
    ACBrCEP: TACBrCEP;
    TBINDICEDescRecibo13: TStringField;
    TBINDICEfgts_inss_inter: TStringField;
    TBINDICEferias_terc_inter: TStringField;
    TBEmpresasindPorte: TStringField;
    TBEmpresasxnac_Resp: TStringField;
    TBEmpresasQualifResp: TStringField;
    TBEmpresasclausula_contra_inde: TMemoField;
    TBEmpresasApresentarAvisoFerias: TStringField;
    TBINDICEAgencia: TStringField;
    TBINDICEAgenciaDigito: TStringField;
    TBINDICECodigoCedente: TStringField;
    TBINDICECodigoTransmissao: TStringField;
    TBINDICEContaDigito: TStringField;
    TBINDICEConvenio: TStringField;
    TBEmpresasQuadro_Informativo_holerite_5: TStringField;
    TBEmpresasSalvarHistConc: TBooleanField;
    TBEmpresasNaoCalcular_1_3_Ferias: TBooleanField;
    TBINDICETextoAntecipacaoFerias: TMemoField;
    TBEmpresasclausula_contra_PagamComMulta: TMemoField;
    TBEmpresasclausula_contra_PagamSemMulta: TMemoField;
    TBEmpresasclausula_suspensao_contrato: TMemoField;
    TBEmpresasclausula_reducao_salarial: TMemoField;
    TBEmpresasEmpfatura: TBooleanField;
    TBEmpresasEmailContador: TStringField;
    TBEmpresasTelefoneContador: TStringField;
    TBINDICEexibeNfPaginacao: TIntegerField;
    TBINDICEinfoLed: TDateTimeField;
    TBINDICEbuscaDinamicaLancsContabil: TStringField;
    TBINDICEexibeContPaginacao: TIntegerField;
    TBINDICEPularCampoComEnter: TIntegerField;
    TBINDICENaoImportarBC_ALIQ_ISS: TIntegerField;
    TBINDICERepetirDadosDuplicatas: TIntegerField;
    TBINDICEEditarConsultarLancsContabil: TStringField;
    TBINDICEHabilitarEFDReinfFiscal: TStringField;
    tbInfoeSocial_Novo: TBooleanField;
    tbInfoperApuracaoComp: TStringField;
    TBEmpresasf_beneficiariosServDmed: TStringField;
    procedure TBEmpresasCOD_EMPRESASetText(Sender: TField;
      const Text: string);
    procedure TBHistoricoBeforeDelete(DataSet: TDataSet);
    procedure TBHistoricoCOD_HISTORICOSetText(Sender: TField;
      const Text: string);
    procedure TBContasCod_ContaSetText(Sender: TField; const Text: string);
    procedure TBContasBeforeDelete(DataSet: TDataSet);
    procedure TBDARFAXPERIODOSetText(Sender: TField; const Text: string);
    procedure TBDARFABeforeDelete(DataSet: TDataSet);
    procedure TBEmpresasf_xdf_rcdpeSetText(Sender: TField; const Text: string);
    procedure ACBrCEPBuscaEfetuada(Sender: TObject);
  end;

var
  DM: TDM;
  vBusca_cep, vBusca_endereco, vBusca_bairro, vBusca_cidade, vBusca_uf : String;


implementation

uses Principal, PwordDlg, BibliotecaPrincipal;

{$R *.DFM}

procedure TDM.TBEmpresasCOD_EMPRESASetText(Sender: TField;
  const Text: string);
begin
     if Valida_CampoL(TBEmpresas,'cod_empresa',Text,'COD_EMPRESA','Codigo já cadastrado.') then
       TBEmpresas.FieldByName('COD_EMPRESA').AsString:=Text;
end;

procedure TDM.TBEmpresasf_xdf_rcdpeSetText(Sender: TField; const Text: string);
begin
   if (Text <> '') and (Text <> '  /  /    ') then
      If VerificaData(Text) then
         (Sender as TField).AsString := data2000
      else
         (Sender as TField).AsString := ''
   else
      (Sender as TField).AsString := '';
end;

procedure TDM.TBHistoricoBeforeDelete(DataSet: TDataSet);
begin
  if MessageDlg('Deseja Eliminar Este Registro',mtConfirmation,
    [mbYes,mbNo],0)=mrNo then begin
    Abort;
  end;
end;

procedure TDM.TBHistoricoCOD_HISTORICOSetText(Sender: TField;
  const Text: string);
begin
  if Valida_CampoL(TBHistorico,'COD_HISTORICO',Text,'COD_HISTORICO','Codigo já Cadastrado') then
    TBHistorico.FieldByName('COD_HISTORICO').AsString:=Text;

end;

procedure TDM.TBContasCod_ContaSetText(Sender: TField; const Text: string);
begin
  if Valida_CampoL(TBCONCX,'COD_CONTA',Text,'COD_CONTA','Codigo já Cadastrado') then
    TBCONCX.FieldByName('COD_CONTA').AsString:=Text;
end;

procedure TDM.ACBrCEPBuscaEfetuada(Sender: TObject);
var
   i : Integer;
begin
   try
      if Trim(vBusca_cep) <> '' then
         for I := 0 to ACBrCEP.Enderecos.Count - 1 do
         begin
            vBusca_endereco  := Trim(AnsiUpperCase(ACBrCEP.Enderecos[i].Tipo_Logradouro)) +' '+ Trim(AnsiUpperCase(ACBrCEP.Enderecos[i].Logradouro));
            vBusca_bairro    := Trim(AnsiUpperCase(ACBrCEP.Enderecos[i].Bairro));
            vBusca_cidade    := Trim(AnsiUpperCase(ACBrCEP.Enderecos[i].Municipio));
            vBusca_uf        := Trim(AnsiUpperCase(ACBrCEP.Enderecos[i].UF));
         end;
   except
   end;
end;

procedure TDM.TBContasBeforeDelete(DataSet: TDataSet);
begin
     if MessageDlg('Deseja Eliminar este Registro?',mtConfirmation,[mbYes,mbNo],0) = mrNo then
        Abort;

end;

procedure TDM.TBDARFAXPERIODOSetText(Sender: TField; const Text: string);
begin
     If NOT VerificaData(Text) then
          Sender.AsString := ''
        else
          Sender.AsString := data2000;
end;

procedure TDM.TBDARFABeforeDelete(DataSet: TDataSet);
begin
     If Application.MessageBox('Excluir Darf?','Confirmação',mb_IConQuestion+mb_YESNO)=idNO then
        abort;
end;

end.
